import base64
from functools import reduce
from operator import ixor

heaps = [647761, 970495, 559170, 744364, 383620, 598715, 614243, 767448, 173736,
812856, 864419, 348955, 402344, 665714, 827970, 377326, 966501, 322577, 410572,
730984, 214902, 798529, 688157, 905792, 956622, 382598, 114598, 446157, 860292,
666053, 418109, 943852, 68518, 529944, 733174, 700577, 365012, 931483, 423193,
422964, 840552, 773372, 838930, 325950, 695992, 18692, 872947, 370326, 623334,
124296, 483324, 258349, 179535, 834374, 893226, 328968, 712259, 724086, 966551,
959552, 633961, 479365, 632726, 277722, 843046, 210745, 574366, 70570, 669359,
550968, 648726, 605341, 811080, 46012, 75747, 427264, 684640, 945700, 649851,
56448, 708417, 17974, 665844, 206381, 206593, 109671, 298767, 206124, 474301,
785501, 961053, 837015, 596303, 329550, 13072, 834046, 982379, 640464, 349797,
453162]

encrypted_b64 = "srlrs65sq5Q7vZg5ooVHkKl+46hH4ZRurQ=="

# 1. Tính nimsum
nimsum = reduce(ixor, heaps)

# 2. Giải mã base64
ciphertext = base64.b64decode(encrypted_b64)

# 3. XOR từng byte với key
# key_byte = nimsum & 0xff
# plaintext = bytes([b ^ key_byte for b in ciphertext])
key = nimsum.to_bytes(16, 'big')  # hoặc độ dài ciphertext
flag = bytes([c ^ key[i % len(key)] for i, c in enumerate(ciphertext)])
print(flag)
# 4. In flag
#print("✅ Flag:", plaintext)
